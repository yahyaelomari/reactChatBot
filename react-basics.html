<!DOCTYPE html>
<html>
<head>
  <title>ChatBot App</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .js-container {
      width: 100%;
      max-width: 800px;
    }

    .app-div {
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      height: 600px;
      display: flex;
      flex-direction: column;
    }

    /* Messages Container */
    .messages-container {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      background: #f8f9fa;
    }

    .sender-message, .robot-message {
      display: flex;
      align-items: flex-end;
      margin-bottom: 15px;
      animation: fadeIn 0.3s ease-in;
    }

    .sender-message {
      justify-content: flex-end;
    }

    .robot-message {
      justify-content: flex-start;
    }

    .message-text {
      padding: 12px 18px;
      border-radius: 18px;
      max-width: 70%;
      line-height: 1.4;
      word-wrap: break-word;
    }

    .sender-message .message-text {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border-bottom-right-radius: 5px;
    }

    .robot-message .message-text {
      background: white;
      color: #333;
      border: 1px solid #e1e5e9;
      border-bottom-left-radius: 5px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }

    .message-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      margin: 0 10px;
      border: 2px solid #fff;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    /* Input Section */
    .input-div {
      display: flex;
      padding: 20px;
      background: white;
      border-top: 1px solid #e1e5e9;
      gap: 10px;
    }

    .input-field {
      flex: 1;
      padding: 12px 16px;
      border: 2px solid #e1e5e9;
      border-radius: 25px;
      font-size: 14px;
      outline: none;
      transition: all 0.3s ease;
    }

    .input-field:focus {
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .input-field::placeholder {
      color: #a0a4a8;
    }

    .send-btn {
      padding: 12px 24px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      border-radius: 25px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      min-width: 80px;
    }

    .send-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    .send-btn:active {
      transform: translateY(0);
    }

    /* Scrollbar Styling */
    .messages-container::-webkit-scrollbar {
      width: 6px;
    }

    .messages-container::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 3px;
    }

    .messages-container::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 3px;
    }

    .messages-container::-webkit-scrollbar-thumb:hover {
      background: #a8a8a8;
    }

    /* Animations */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Loading State */
    .loading-dots {
      display: inline-block;
    }

    .loading-dots::after {
      content: '...';
      animation: dots 1.5s steps(4, end) infinite;
    }

    @keyframes dots {
      0%, 20% { content: '.'; }
      40% { content: '..'; }
      60%, 100% { content: '...'; }
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .app-div {
        height: 500px;
        border-radius: 15px;
      }

      .message-text {
        max-width: 85%;
      }

      .input-div {
        padding: 15px;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 10px;
      }

      .app-div {
        height: 100vh;
        border-radius: 0;
      }

      .messages-container {
        padding: 15px;
      }

      .message-text {
        max-width: 90%;
        padding: 10px 15px;
      }

      .message-avatar {
        width: 35px;
        height: 35px;
        margin: 0 8px;
      }
    }
  </style>
</head>
<body>
<div class="js-container"></div>

<script src="https://unpkg.com/supersimpledev/react.js"></script>
<script src="https://unpkg.com/supersimpledev/react-dom.js"></script>
<script src="https://unpkg.com/supersimpledev/chatbot.js"></script>
<script src="https://unpkg.com/supersimpledev/babel.js"></script>
<script type="text/babel">
  function ChatInput({chatMessages,setChatMessages}){
    const [chatInput,setChatInput] = React.useState('');
    const [isLoading,setIsLoading] = React.useState(false);

    function watchInput(event){
      setChatInput(event.target.value);
    }

    async function sendMessage(){
      if(!chatInput.trim() || isLoading) return;

      setIsLoading(true);

      const newHumanMessage = {
        "message": chatInput,
        "sender": "human",
        "id": crypto.randomUUID()
      }

      try {
        const response = await Chatbot.getResponseAsync(chatInput);

        const newRobotResponse = {
          "message": response,
          "sender": "robot",
          "id": crypto.randomUUID()
        }

        setChatMessages(prev => [
          ...prev,
          newHumanMessage,
          newRobotResponse
        ]);
      } catch (error) {
        const errorMessage = {
          "message": "Sorry, I encountered an error. Please try again.",
          "sender": "robot",
          "id": crypto.randomUUID()
        }
        setChatMessages(prev => [
          ...prev,
          newHumanMessage,
          errorMessage
        ]);
      } finally {
        setIsLoading(false);
        setChatInput('');
      }
    }

    function handleKeyDown(event){
      if(event.key === "Enter") sendMessage();
      else if(event.key === "Escape") setChatInput('');
    }

    return(
            <div className="input-div">
              <input
                      className="input-field"
                      onChange={watchInput}
                      onKeyDown={handleKeyDown}
                      value={chatInput}
                      placeholder="Type your message here..."
                      disabled={isLoading}
              />
              <button
                      className="send-btn"
                      onClick={sendMessage}
                      disabled={isLoading || !chatInput.trim()}
              >
                {isLoading ? 'Sending...' : 'Send'}
              </button>
            </div>
    );
  }

  function MessageBox({message,sender}){
    return(
            <div className={sender === "human" ? "sender-message" : "robot-message"}>
              {sender === "robot" && <img src="images/robot.png" className="message-avatar" alt="Robot" />}
              <div className="message-text">
                {message}
              </div>
              {sender === "human" && <img src="images/user.png" className="message-avatar" alt="User" />}
            </div>
    );
  }

  function GenerateMessages({chatMessages}){
    const containerElemRef = React.useRef(null)
    React.useEffect(
            ()=>{
              const containerElem = containerElemRef.current;
              if(containerElem) {
                containerElem.scrollTop=containerElem.scrollHeight
              }
            },
            [chatMessages]
    )



    return (
            <div className="messages-container" ref={containerElemRef}>
              {chatMessages.map((chatMessage) => (
                      <MessageBox
                              key={chatMessage.id}
                              message={chatMessage.message}
                              sender={chatMessage.sender}
                      />
              ))}
            </div>
    );
  }

  function App(){
    const [chatMessages,setChatMessages] = React.useState([
      {
        "message": "Hello! I'm your AI assistant. How can I help you today?",
        "sender": "robot",
        "id": "welcome-1"
      }
    ]);

    return (
            <div className="app-div">
              <GenerateMessages chatMessages={chatMessages} />
              <ChatInput
                      chatMessages={chatMessages}
                      setChatMessages={setChatMessages}
              />
            </div>
    );
  }

  const container = document.querySelector('.js-container');
  ReactDOM.createRoot(container).render(<App />);
</script>
</body>
</html>